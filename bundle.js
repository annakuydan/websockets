!function(){var e={25:function(){const e=new WebSocket("https://websocketsserver-qyj7.onrender.com");e.onopen=()=>{console.log("==> Connected to WebSocket server")},e.onclose=()=>{console.log("==> Disconnected from WebSocket server")},e.onmessage=e=>{const t=JSON.parse(e.data);console.log("==> Received:",t)},document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("nickname-modal"),t=document.getElementById("nickname-input"),n=document.getElementById("nickname-submit"),s=document.getElementById("clear-history");n.addEventListener("click",(()=>{const n=t.value.trim();n?async function(t){try{const n=await fetch("https://websocketsserver.onrender.com/new-user",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:t})}),o=await n.json();"ok"===o.status?(console.log("==> Никнейм принят:",o.user.name),e.style.display="none",function(e){const t=document.getElementById("chat-container"),n=document.getElementById("message-input"),o=document.getElementById("send-message"),r=document.getElementById("messages"),a=document.getElementById("users");t.style.display="flex";const c=new WebSocket("wss://websocketsserver.onrender.com"),i=setInterval((()=>{c.readyState===WebSocket.OPEN&&c.send(JSON.stringify({type:"ping",user:{name:e}}))}),3e3);function d(){const t=n.value.trim();if(t){const s={type:"send",message:t,user:{name:e},timestamp:(new Date).toISOString()};c.send(JSON.stringify(s)),m({...s,user:{name:"You"}}),n.value=""}}function m(e){const t=document.createElement("div");t.className="You"===e.user.name?"my-message":"other-message";const n=document.createElement("div");n.className="message-meta";const s=new Date(e.timestamp||Date.now()),o=s.toLocaleDateString(),a=s.toLocaleTimeString();n.innerHTML=`<strong>${e.user.name}:</strong> <span class="timestamp">${o} ${a}</span>`;const c=document.createElement("div");c.className="message-text",c.textContent=e.message,t.appendChild(n),t.appendChild(c),r.appendChild(t),r.scrollTop=r.scrollHeight}function l(t){a.innerHTML="",t.forEach((t=>{const n=document.createElement("li");n.textContent=t.name===e?"You":t.name,t.name===e&&n.classList.add("current-user"),a.appendChild(n)}))}c.onopen=()=>{c.send(JSON.stringify({type:"join",user:{name:e}}))},c.onmessage=t=>{const n=JSON.parse(t.data);if(Array.isArray(n)){l(n.filter((e=>""!==e.name)))}else"send"===n.type?n.user.name!==e&&m(n):"history"===n.type&&(r.innerHTML="",n.data.forEach((e=>m(e))))},n.addEventListener("keydown",(e=>{"Enter"===e.key&&(e.preventDefault(),d())})),o.addEventListener("click",d),s.addEventListener("click",(()=>{c.send(JSON.stringify({type:"clear"})),r.innerHTML=""})),window.addEventListener("beforeunload",(()=>{c.send(JSON.stringify({type:"exit",user:{name:e}})),c.close(),clearInterval(i)})),document.addEventListener("visibilitychange",(()=>{"hidden"===document.visibilityState&&(c.send(JSON.stringify({type:"exit",user:{name:e}})),c.close())}))}(t)):alert(o.message)}catch(e){console.error("Ошибка при проверке никнейма:",e)}}(n):alert("Пожалуйста, введите псевдоним.")}))}))}},t={};function n(s){var o=t[s];if(void 0!==o)return o.exports;var r=t[s]={exports:{}};return e[s](r,r.exports,n),r.exports}n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var s in t)n.o(t,s)&&!n.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){"use strict";n(25)}()}();
//# sourceMappingURL=bundle.js.map